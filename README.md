# GeoSight in-da-house ğŸ ğŸŒ

Raspberry Pi ä¸Šã§ [GeoSight](https://github.com/unicef-drp/GeoSight-OS) ã‚’ç°¡å˜ã«ç«‹ã¡ä¸Šã’ã‚‹ãŸã‚ã® Justfile ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ„ãƒ¼ãƒ«ã€‚

## èƒŒæ™¯ / Background

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€[UN Smart Maps](https://github.com/UNopenGIS/7) ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ã€Œæ–°ã—ã„æŠ€è¡“ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã«ä¿ã¡ãªãŒã‚‰ãƒ†ã‚¹ãƒˆã™ã‚‹ã€ã®ä¸€ç’°ã¨ã—ã¦ã€UNICEF ã® GeoSight ã‚’ Raspberry Pi ç’°å¢ƒã§ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚

GeoSight ã¯ UNICEF ã®åœ°ç†ç©ºé–“ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã€åœ°ç†ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–ã¨åˆ†æã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å°è¦æ¨¡ãª Raspberry Pi ç’°å¢ƒã§ã® GeoSight ã®ç¨¼åƒã‚’å¯èƒ½ã«ã—ã€ã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„æ•™è‚²ç’°å¢ƒã§ã®åˆ©ç”¨ã‚’ä¿ƒé€²ã—ã¾ã™ã€‚

## ãªãœã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä¾¡å€¤ãŒã‚ã‚‹ã®ã‹ / Why This Project is Valuable

### ğŸŒ åœ°ç†ç©ºé–“æŠ€è¡“ã®æ°‘ä¸»åŒ– / Democratizing Geospatial Technology

GeoSight ã¯æœ¬æ¥ã€å¼·åŠ›ãªã‚µãƒ¼ãƒãƒ¼ã‚¤ãƒ³ãƒ•ãƒ©ã‚’å¿…è¦ã¨ã™ã‚‹ UNICEF ã®åœ°ç†ç©ºé–“ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ã‚ãšã‹æ•°åƒå††ã® Raspberry Pi ã§ã“ã®å…ˆé€²çš„ãªæŠ€è¡“ã‚’å‹•ã‹ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã‚’å®Ÿç¾ã—ã¾ã™ï¼š

- **æ•™è‚²æ©Ÿé–¢ã§ã®æ´»ç”¨**: é™ã‚‰ã‚ŒãŸäºˆç®—ã§ã‚‚åœ°ç†ç©ºé–“ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’å­¦ç¿’ãƒ»ç ”ç©¶ã§ãã‚‹
- **é–‹ç™ºé€”ä¸Šå›½ã§ã®å±•é–‹**: é«˜ä¾¡ãªã‚µãƒ¼ãƒãƒ¼ã‚¤ãƒ³ãƒ•ãƒ©ãªã—ã§åœ°åŸŸã®åœ°ç†æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã‚‹
- **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç’°å¢ƒã§ã®åˆ©ç”¨**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒä¸å®‰å®šãªåœ°åŸŸã§ã‚‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ GeoSight ã‚’é‹ç”¨ã§ãã‚‹
- **å€‹äººé–‹ç™ºè€…ã®å‚å…¥éšœå£ä½æ¸›**: æ°—è»½ã« GeoSight ã‚’è©¦ã—ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒ»é–‹ç™ºã§ãã‚‹

### ğŸš€ ã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®å®Ÿè¨¼ / Edge Computing Demonstration

Raspberry Pi ä¸Šã§ GeoSight ã‚’å‹•ä½œã•ã›ã‚‹ã“ã¨ã¯ã€ã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®å¯èƒ½æ€§ã‚’ç¤ºã™é‡è¦ãªå®Ÿè¨¼å®Ÿé¨“ã§ã™ï¼š

- **ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„ä¸‹ã§ã®æœ€é©åŒ–**: é™ã‚‰ã‚ŒãŸ CPUãƒ»ãƒ¡ãƒ¢ãƒªã§ã‚‚å‹•ä½œã™ã‚‹è¨­å®šã¨ãƒã‚¦ãƒã‚¦ã‚’æä¾›
- **ARM ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¯¾å¿œ**: ã‚¯ãƒ©ã‚¦ãƒ‰ä¸­å¿ƒã® x86 ã‹ã‚‰ ARM ã¸ã®ç§»è¡Œã‚’å®Ÿè¨¼
- **çœé›»åŠ›ãƒ»å°å‹åŒ–**: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ä¸è¦ã§ã€ç¾åœ°ã§å®Œçµã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿç¾

### ğŸ› ï¸ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®è‡ªå‹•åŒ– / Setup Automation

GeoSight-OS ã®å…¬å¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¯è¤‡æ•°ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’æ‰‹å‹•ã§å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ç‰¹ã«åˆå¿ƒè€…ã«ã¯é›£æ˜“åº¦ãŒé«˜ã„ã§ã™ã€‚æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ï¼š

- **ãƒ¯ãƒ³ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**: `just doit` ã§å®Œå…¨ã«è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- **ç’°å¢ƒå›ºæœ‰ã®æœ€é©åŒ–**: Raspberry Pi ç‰¹æœ‰ã®åˆ¶ç´„ï¼ˆI/O é€Ÿåº¦ã€ãƒ¡ãƒ¢ãƒªã€ARM ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼‰ã«æœ€é©åŒ–
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**: è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ã€é©åˆ‡ãªãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³è¨­å®š
- **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–ã‚’æ–‡æ›¸åŒ–

### ğŸŒ UN Smart Maps ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã®è²¢çŒ® / Contributing to UN Smart Maps Community

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€UN Smart Maps ã®ã€Œã‚ªãƒ¼ãƒ—ãƒ³ã«æŠ€è¡“ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã€ã¨ã„ã†ãƒŸãƒƒã‚·ãƒ§ãƒ³ã«æ²¿ã£ã¦ã„ã¾ã™ï¼š

- **çŸ¥è­˜ã®å…±æœ‰**: [UNopenGIS/7#821](https://github.com/UNopenGIS/7/issues/821) ã§å¾—ã‚‰ã‚ŒãŸçŸ¥è¦‹ã‚’å†åˆ©ç”¨å¯èƒ½ãªå½¢ã§æä¾›
- **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®æ‹¡å¤§**: ã‚ˆã‚Šå¤šãã®äººãŒ GeoSight ã‚’è©¦ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ™ãƒ¼ã‚¹ã¨é–‹ç™ºè€…ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚’æ‹¡å¤§
- **ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—**: Raspberry Pi ã§ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸçŸ¥è¦‹ã‚’ UNICEF ã®é–‹ç™ºã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

### ğŸ“š å®Ÿç”¨çš„ãªä¾¡å€¤ / Practical Value

å…·ä½“çš„ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼š

1. **ç½å®³å¯¾å¿œ**: ç¾åœ°ã«æŒã¡è¾¼ã‚ã‚‹å°å‹ãƒ‡ãƒã‚¤ã‚¹ã§ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§åœ°ç†æƒ…å ±ã‚’ç®¡ç†ãƒ»å¯è¦–åŒ–
2. **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ¯ãƒ¼ã‚¯**: èª¿æŸ»åœ°åŸŸã§å³åº§ã«ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ãƒ»åˆ†æ
3. **æ•™è‚²ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—**: å­¦ç”Ÿä¸€äººä¸€å°ã®ç’°å¢ƒã§ã€å®Ÿè·µçš„ãªåœ°ç†ç©ºé–“ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’å­¦ç¿’
4. **é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒ**: æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆãšã«ã€æ–°æ©Ÿèƒ½ã‚„ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚’è©¦è¡Œ

## å¯¾å¿œç’°å¢ƒ / Supported Environment

- **OS**: Raspberry Pi OS trixie (Debian 13) 64-bit
- **Hardware**: Raspberry Pi 4B (4GB RAM æ¨å¥¨ã€æœ€ä½ 2GB)
- **Storage**: 32GB ä»¥ä¸Šã® microSD ã‚«ãƒ¼ãƒ‰ã¾ãŸã¯ SSD

## å‰ææ¡ä»¶ / Prerequisites

- Raspberry Pi OS trixie 64-bit ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶š
- [just](https://github.com/casey/just) ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ©ãƒ³ãƒŠãƒ¼

> ğŸ’¡ **Tip**: [niroku](https://github.com/unvt/niroku) ã‚’äº‹å‰ã«å°å…¥ã—ã¦ã„ã‚‹å ´åˆã€just ã¯æ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã¾ã™ã€‚niroku ã¯ UNVT Portable ã®æ–°å®Ÿè£…ã§ã€Raspberry Pi ä¸Šã«ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åœ°å›³ã‚µãƒ¼ãƒãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®åŒ…æ‹¬çš„ãªãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã‚’æä¾›ã—ã¾ã™ã€‚

### just ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# Debian/Raspberry Pi OS
sudo apt-get update
sudo apt-get install -y just

# ã¾ãŸã¯ã€å…¬å¼ãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl --proto '=https' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to /usr/local/bin
```

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ / Quick Start

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/hfu/geosight-in-da-house.git
cd geosight-in-da-house

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨èµ·å‹•ã‚’ä¸€åº¦ã«å®Ÿè¡Œ
just doit
```

> âš ï¸ **æ³¨æ„ / Note**: åˆå›ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã« Docker ã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®è¿½åŠ ãŒå¿…è¦ãªå ´åˆã€`just install` ãŒé€”ä¸­ã§çµ‚äº†ã—ã¾ã™ã€‚ãã®å ´åˆã¯ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ»ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ `just run` ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚è©³ç´°ã¯[ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#docker-ã‚°ãƒ«ãƒ¼ãƒ—ã‚¨ãƒ©ãƒ¼)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ãŸã‚‰ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:2000/ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚

- **ãƒ¦ãƒ¼ã‚¶ãƒ¼å**: admin
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: admin

> âš ï¸ **é‡è¦ / Important**: åˆå›ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ã™ãã«ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ï¼
> After first login, change the admin password immediately!

## ã‚¿ã‚¹ã‚¯ä¸€è¦§ / Available Tasks

| ã‚¿ã‚¹ã‚¯ | èª¬æ˜ |
|--------|------|
| `just install` | å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ GeoSight-OS ã®ã‚¯ãƒ­ãƒ¼ãƒ³ |
| `just run` | GeoSight ã®èµ·å‹•ï¼ˆé–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼‰ |
| `just stop` | GeoSight ã®åœæ­¢ |
| `just restart` | GeoSight ã®å†èµ·å‹• |
| `just uninstall` | GeoSight ã®å®Œå…¨å‰Šé™¤ |
| `just tunnel` | Cloudflare Tunnel ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å…¬é–‹ |
| `just doit` | install ã¨ run ã‚’ç¶šã‘ã¦å®Ÿè¡Œ |
| `just status` | ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª |
| `just logs` | ãƒ­ã‚°ã®è¡¨ç¤º |
| `just shell` | Django ã‚·ã‚§ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ |
| `just clean` | æœªä½¿ç”¨ã® Docker ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ |
| `just info` | ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã®è¡¨ç¤º |

## è©³ç´°ãªä½¿ã„æ–¹ / Detailed Usage

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
just install
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š
1. å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆgit, docker.io, docker-compose-plugin, curl, makeï¼‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
2. Docker ã‚µãƒ¼ãƒ“ã‚¹ã®æœ‰åŠ¹åŒ–ã¨èµ·å‹•
3. ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ docker ã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ 
4. GeoSight-OS ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
5. Raspberry Pi ç”¨ã«æœ€é©åŒ–ã•ã‚ŒãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆ
6. **ARM64 ã®å ´åˆ**: PostGIS ã¨ pg-backup ç”¨ã®ã‚«ã‚¹ã‚¿ãƒ  Dockerfile ã‚’è‡ªå‹•ã‚³ãƒ”ãƒ¼

### èµ·å‹•

```bash
just run
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š
1. **ARM64 ã®å ´åˆ**: PostGIS ã¨ pg-backup ã‚’ Dockerfile ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ï¼ˆåˆå›ã®ã¿ 15-30 åˆ†ï¼‰
2. Docker ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•
3. GeoSight ã®åˆæœŸåŒ–
4. ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã®ãƒ­ãƒ¼ãƒ‰

èµ·å‹•ã«ã¯ Raspberry Pi 4B ã§ä»¥ä¸‹ã®æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ï¼š
- åˆå›èµ·å‹•ï¼ˆãƒ“ãƒ«ãƒ‰ã‚ã‚Šï¼‰: 30-60 åˆ†
- 2 å›ç›®ä»¥é™: 10-15 åˆ†

**é‡è¦**: ARM64 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (Raspberry Pi) ã§ã¯ã€`kartoza/postgis:13.0` ãªã©ã® Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã« ARM64 å¯¾å¿œç‰ˆãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€åˆå›èµ·å‹•æ™‚ã«è‡ªå‹•çš„ã« Dockerfile ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚ã“ã‚Œã«ã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ãŒã€2 å›ç›®ä»¥é™ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚é«˜é€Ÿã§ã™ã€‚

### Cloudflare Tunnel ã«ã‚ˆã‚‹å…¬é–‹

```bash
just tunnel
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€Cloudflare Tunnel ã‚’ä½¿ç”¨ã—ã¦ GeoSight ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å…¬é–‹ã—ã¾ã™ã€‚ä¸€æ™‚çš„ãªå…¬é–‹ URL ãŒç”Ÿæˆã•ã‚Œã€å¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

**æ³¨æ„**: æœ¬ç•ªç’°å¢ƒã§ã®ä½¿ç”¨ã«ã¯é©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ãŒå¿…è¦ã§ã™ã€‚

## è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ / Configuration Parameters

### Justfile å¤‰æ•°

Justfile ã®å¤‰æ•°ã¯ `just --set` ã§ä¸Šæ›¸ãã§ãã¾ã™ï¼š

```bash
# ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ãƒˆã§èµ·å‹•
just --set HTTP_PORT 8080 run

# ã‚«ã‚¹ã‚¿ãƒ ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ã‚¯ãƒ­ãƒ¼ãƒ³
just --set GEOSIGHT_REPO https://github.com/your-fork/GeoSight-OS.git install
```

| å¤‰æ•° | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ | èª¬æ˜ |
|------|-------------|------|
| `GEOSIGHT_DIR` | GeoSight-OS | GeoSight-OS ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå |
| `HTTP_PORT` | 2000 | HTTP ãƒãƒ¼ãƒˆç•ªå· |
| `HTTPS_PORT` | 2443 | HTTPS ãƒãƒ¼ãƒˆç•ªå· |
| `COMPOSE_HTTP_TIMEOUT` | 300 | Docker Compose HTTP ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç§’ï¼‰ |
| `DOCKER_CLIENT_TIMEOUT` | 300 | Docker ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç§’ï¼‰ |

### ç’°å¢ƒå¤‰æ•°

`GeoSight-OS/deployment/.env` ãƒ•ã‚¡ã‚¤ãƒ«ã§è¨­å®šã‚’å¤‰æ›´ã§ãã¾ã™ï¼š

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ | èª¬æ˜ |
|-----------|-------------|------|
| `HTTP_PORT` | 2000 | HTTP ãƒãƒ¼ãƒˆç•ªå· |
| `HTTPS_PORT` | 2443 | HTTPS ãƒãƒ¼ãƒˆç•ªå· |
| `ADMIN_USERNAME` | admin | ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼å |
| `ADMIN_PASSWORD` | admin | ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ |
| `SECRET_KEY` | (è‡ªå‹•ç”Ÿæˆ) | Django ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ |
| `PLUGINS` | cloud_native_gis,reference_dataset | æœ‰åŠ¹ã«ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ |

### Raspberry Pi æœ€é©åŒ–è¨­å®š

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€Raspberry Pi ã®åˆ¶é™ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã«å¯¾å¿œã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®æœ€é©åŒ–ã‚’è¡Œã£ã¦ã„ã¾ã™:

- **Docker ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ**: 300ç§’ï¼ˆé€šå¸¸ã‚ˆã‚Šé•·ã‚ï¼‰
- **ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**: 7æ—¥åˆ†ã€50MB/ãƒ•ã‚¡ã‚¤ãƒ«
- **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**: æœ€å°é™ï¼ˆcloud_native_gis, reference_datasetï¼‰
- **Webpack æœ¬ç•ªãƒ“ãƒ«ãƒ‰**: é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰ã‹ã‚‰æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ
  - CPU ä½¿ç”¨ç‡ã‚’ 180% ã‹ã‚‰ ã»ã¼ 0% ã«å‰Šæ¸›
  - ãƒ¡ãƒ¢ãƒªåˆ¶é™: 1.5GBï¼ˆ4GB RAM ã®ç´„ 1/3ï¼‰
  - npm ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ node_modules ã®æ°¸ç¶šåŒ–ã§ 2 å›ç›®ä»¥é™ã®èµ·å‹•ã‚’é«˜é€ŸåŒ–

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° / Troubleshooting

### "exec format error" ã‚¨ãƒ©ãƒ¼

Docker ãƒ“ãƒ«ãƒ‰æ™‚ã«ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆï¼š

```
exec /bin/sh: exec format error
```

**åŸå› **: Docker ãŒãƒ“ãƒ«ãƒ‰æ™‚ã«é–“é•ã£ãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã® base ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«ã—ã¦ã„ã‚‹

**è§£æ±ºç­–**:
1. æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ ARM64 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è‡ªå‹•æ¤œå‡ºã—ã€é©åˆ‡ãª platform è¨­å®šã‚’è¡Œã„ã¾ã™
2. `just install` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ARM64 å¯¾å¿œã® docker-compose ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™
3. docker-compose ã® `build.platform` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ `linux/arm64` ã«è¨­å®šã•ã‚Œã€æ­£ã—ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã® base ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒä½¿ç”¨ã•ã‚Œã¾ã™
4. DOCKER_DEFAULT_PLATFORM ç’°å¢ƒå¤‰æ•°ã‚‚è‡ªå‹•çš„ã«è¨­å®šã•ã‚Œã¾ã™

### Platform/Architecture ã‚¨ãƒ©ãƒ¼

ARM64 (aarch64) ã¨ AMD64 (x86_64) ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ä¸ä¸€è‡´ã«é–¢ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆï¼š

```
Error response from daemon: image with reference kartoza/postgis:13.0 was found but does not match the specified platform: wanted linux/arm64, actual: linux/amd64
```

ã¾ãŸã¯

```
The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8)
```

**åŸå› **: `kartoza/postgis:13.0` ãªã©ã®ä¸€éƒ¨ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã« ARM64 å¯¾å¿œç‰ˆãŒå­˜åœ¨ã—ãªã„

**è§£æ±ºç­–**:
1. æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ ARM64 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è‡ªå‹•æ¤œå‡ºã—ã€ä»¥ä¸‹ã®å¯¾ç­–ã‚’å®Ÿæ–½ã—ã¾ã™ï¼š
   - ARM64 éå¯¾å¿œã‚¤ãƒ¡ãƒ¼ã‚¸ç”¨ã®ã‚«ã‚¹ã‚¿ãƒ  Dockerfile ã‚’è‡ªå‹•ã‚³ãƒ”ãƒ¼
   - ARM64 ç”¨ã® docker-compose ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ« (`docker-compose.override.arm64.yml`) ã‚’è‡ªå‹•ç”Ÿæˆ
   - `just run` å®Ÿè¡Œæ™‚ã« ARM64 å¯¾å¿œã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ Dockerfile ã‹ã‚‰ãƒ“ãƒ«ãƒ‰
2. **åˆå›ãƒ“ãƒ«ãƒ‰æ™‚é–“**: PostGIS ã¨ pg-backup ã®ãƒ“ãƒ«ãƒ‰ã« Raspberry Pi ã§ 15-30 åˆ†ç¨‹åº¦ã‹ã‹ã‚Šã¾ã™ã€‚2 å›ç›®ä»¥é™ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚é«˜é€Ÿã§ã™ã€‚
3. `just install` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ARM64 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®æ¤œå‡ºã¨è¨­å®šãŒè‡ªå‹•çš„ã«è¡Œã‚ã‚Œã¾ã™
4. **æ—¢å­˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆ**: GeoSight-OS ãŒæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€`just install` ã‚’å†å®Ÿè¡Œã—ã¦ ARM64 å¯¾å¿œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„
5. ãƒ“ãƒ«ãƒ‰ãŒå®Œäº†ã—ã¦ã„ã‚‹ã‹ç¢ºèªï¼š
   ```bash
   # ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç¢ºèª
   uname -m
   
   # ARM64 ç”¨ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒãƒ“ãƒ«ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
   docker images | grep geosight
   
   # ARM64 ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
   ls -la GeoSight-OS/deployment/docker-compose.override.arm64.yml
   ls -la GeoSight-OS/deployment/dockerfiles/
   ```


### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

```
could not translate host name "db" to address: Name or service not known
```

**åŸå› **: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚³ãƒ³ãƒ†ãƒŠãŒã¾ã èµ·å‹•ã—ã¦ã„ãªã„ã€ã¾ãŸã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã®å•é¡Œ

**è§£æ±ºç­–**:
1. æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯è‡ªå‹•çš„ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æº–å‚™å®Œäº†ã‚’å¾…æ©Ÿã—ã¾ã™ï¼ˆ`pg_isready` ã‚’ä½¿ç”¨ï¼‰
2. æ‰‹å‹•ã§ç¢ºèªã™ã‚‹å ´åˆï¼š
   ```bash
   # ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ã‚’ç¢ºèª
   just status
   
   # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ­ã‚°ã‚’ç¢ºèª
   just logs | grep db
   
   # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æº–å‚™å®Œäº†ã‚’ç¢ºèª
   cd GeoSight-OS
   docker compose -f deployment/docker-compose.yml -f deployment/docker-compose.override.yml \
       exec db pg_isready -U docker -d django
   ```
3. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒè¶³ã‚Šãªã„å ´åˆã€Justfile ã® `MAX_ATTEMPTS` ã‚’å¢—ã‚„ã™ã“ã¨ãŒã§ãã¾ã™

### Docker ã‚°ãƒ«ãƒ¼ãƒ—ã‚¨ãƒ©ãƒ¼

åˆå›ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€docker ã‚°ãƒ«ãƒ¼ãƒ—ãŒåæ˜ ã•ã‚Œã‚‹ã¾ã§ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ»ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ï¼š

```bash
# ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
exit
# å†åº¦ãƒ­ã‚°ã‚¤ãƒ³å¾Œ
just install
```

### ãƒ¡ãƒ¢ãƒªä¸è¶³

Raspberry Pi 4B (2GB) ã§ãƒ¡ãƒ¢ãƒªä¸è¶³ãŒç™ºç”Ÿã™ã‚‹å ´åˆã€ã‚¹ãƒ¯ãƒƒãƒ—ã‚’å¢—ã‚„ã—ã¦ãã ã•ã„ï¼š

```bash
sudo dphys-swapfile swapoff
sudo sed -i 's/CONF_SWAPSIZE=.*/CONF_SWAPSIZE=2048/' /etc/dphys-swapfile
sudo dphys-swapfile setup
sudo dphys-swapfile swapon
```

### ãƒ“ãƒ«ãƒ‰ãŒé…ã„

Raspberry Pi ã§ã¯ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã«æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚åˆå›ãƒ“ãƒ«ãƒ‰ã«ã¯ 30-60 åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ / Security

### æœ¬ç•ªç’°å¢ƒã§ã®æ³¨æ„äº‹é …

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç›®çš„ã§è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š

1. **ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® `admin/admin` ã‚’å¿…ãšå¤‰æ›´ã—ã€å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ãã ã•ã„
2. **SECRET_KEY, DATABASE_PASSWORD, REDIS_PASSWORD**: ã“ã‚Œã‚‰ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ååˆ†ãªã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã§è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚é€šå¸¸ã¯å¤‰æ›´ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ä¸‡ãŒä¸€æ¼æ´©ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸå ´åˆã¯å†ç”Ÿæˆã—ã¦ãã ã•ã„
3. **ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«**: å¿…è¦ãªãƒãƒ¼ãƒˆã®ã¿ã‚’é–‹æ”¾ã—ã¦ãã ã•ã„
4. **Cloudflare Tunnel**: æœ¬ç•ªç’°å¢ƒã§ã¯èªè¨¼ã‚’è¿½åŠ ã—ã¦ãã ã•ã„

### Cloudflare Tunnel ã®æ³¨æ„

`just tunnel` ã§ä½œæˆã•ã‚Œã‚‹ãƒˆãƒ³ãƒãƒ«ã¯ä¸€æ™‚çš„ãªã‚‚ã®ã§ã€èªè¨¼ãªã—ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™ã€‚é•·æœŸé‹ç”¨ã‚„æœ¬ç•ªç’°å¢ƒã§ã¯ã€Cloudflare Zero Trust ã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚

## æŠ€è¡“çš„æˆæœ / Technical Achievements

### Core Optimizations
- âœ… **Webpack CPU**: 180% â†’ 0.01% (near-zero, production build)
- âœ… **Production Mode**: nginx + django + postgres (no dev server)
- âœ… **Resource Efficiency**: All services under 5% CPU at idle
- âœ… **Memory Optimized**: 1536MB limit for webpack build, npm cache persistence

### ARM64 Compatibility
- âœ… **Custom Builds**: PostGIS 13-3.4 and pg-backup from source
- âœ… **Platform Override**: `docker-compose.override.arm64.yml` with proper isolation
- âœ… **Logrotate Solution**: Alpine Linux replacement (6-year-old blacklabelops image bypassed)
- âœ… **Docker Buildx**: Multi-platform builds with binfmt/qemu emulation

### Automation & DevOps
- âœ… **Two-Command Setup**: `just install; just run` - that's it
- âœ… **Idempotent Scripts**: Re-run safe, self-healing overrides
- âœ… **Template System**: Base â†’ Override â†’ ARM64 â†’ Production chain
- âœ… **Security Defaults**: Random secrets, proper ownership (redis 999:999)
- âœ… **Health Checks**: Database ready detection, 5-minute timeout
- âœ… **Compose V2**: Obsolete `version:` keys sanitized automatically

### Infrastructure as Code
- âœ… **Justfile**: 817 lines of Raspberry Pi optimization
- âœ… **Git-based Workflow**: Templates copied to deployment/ on install
- âœ… **Makefile Integration**: `${ARGS}` variable (not `COMPOSE_FILE` env)
- âœ… **Override Refresh**: Auto-repair malformed YAML from earlier runs

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ / Performance Metrics

| Service | CPU (Idle) | CPU (Peak) | Memory | Notes |
|---------|-----------|-----------|--------|-------|
| django | 0.01% | 270% (build) | ~400MB | uWSGI workers |
| nginx | 0.00% | <1% | ~10MB | Static files + proxy |
| postgres | 0.00% | 33% (init) | ~100MB | PostGIS enabled |
| redis | 1.30% | ~2% | ~15MB | Cache + Celery |
| worker | 0.15% | ~5% | ~300MB | Celery tasks |
| celery_beat | 0.00% | 98% (init) | ~200MB | Scheduler |
| logrotate | 0.00% | 0.00% | ~1MB | Alpine stub (disabled) |

**Total Idle**: ~5% CPU, ~1.1GB RAM - leaves 2.9GB for OS and browser on 4GB Pi

## é–‹ç™ºã®æ•™è¨“ / Lessons Learned

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºã§å¾—ã‚‰ã‚ŒãŸé‡è¦ãªçŸ¥è¦‹ï¼š

### ARM64 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¯¾å¿œ

1. **Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã®äº’æ›æ€§**:
   - ã™ã¹ã¦ã® Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã« ARM64 å¯¾å¿œç‰ˆãŒã‚ã‚‹ã‚ã‘ã§ã¯ãªã„
   - `kartoza/postgis:13.0` ã¨ `kartoza/pg-backup:13.0` ã¯ AMD64 ã®ã¿
   - ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ Raspberry Pi ã®ã‚ˆã†ãªé™ã‚‰ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã§ã¯ç¾å®Ÿçš„ã§ãªã„

2. **Dockerfile ã‹ã‚‰ã®ãƒ“ãƒ«ãƒ‰æˆ¦ç•¥**:
   - å…¬å¼ã® ARM64 å¯¾å¿œãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆ`postgis/postgis:13-3.4-alpine`ï¼‰ã‚’ä½¿ç”¨
   - ç’°å¢ƒå¤‰æ•°ã®äº’æ›æ€§ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ ï¼ˆ`POSTGRES_PASS` â†’ `POSTGRES_PASSWORD` ãªã©ï¼‰
   - åˆå›ãƒ“ãƒ«ãƒ‰ã«æ™‚é–“ãŒã‹ã‹ã‚‹ãŒã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚Š 2 å›ç›®ä»¥é™ã¯é«˜é€ŸåŒ–

3. **docker-compose ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰**:
   - ARM64 å°‚ç”¨ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã§é¸æŠçš„ã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
   - æ—¢å­˜ã® docker-compose.yml ã‚’å¤‰æ›´ã›ãšã« ARM64 å¯¾å¿œã‚’è¿½åŠ 
   - `COMPOSE_FILE` ç’°å¢ƒå¤‰æ•°ã§è¤‡æ•°ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€£çµ

4. **"exec format error" ã®è§£æ±º**:
   - Docker ãƒ“ãƒ«ãƒ‰æ™‚ã® "exec format error" ã¯ã€é–“é•ã£ãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã® base ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒãƒ—ãƒ«ã•ã‚Œã‚‹ã“ã¨ãŒåŸå› 
   - docker-compose ã® `build.platform` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§æ˜ç¤ºçš„ã«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§è§£æ±º
   - Dockerfile å†…ã§ `--platform` ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã®ã¯ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã¯ãªã„ï¼ˆãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ“ãƒ«ãƒ‰ã‚’å¦¨ã’ã‚‹ï¼‰
   - `DOCKER_DEFAULT_PLATFORM` ç’°å¢ƒå¤‰æ•°ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ç¢ºå®Ÿã«æ­£ã—ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ä½¿ç”¨

### Raspberry Pi æœ€é©åŒ–

1. **ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„ã¸ã®å¯¾å¿œ**:
   - Docker ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’ 300 ç§’ã«å»¶é•·ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ 60 ç§’ï¼‰
   - ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ 7 æ—¥ã€50MB ã«å‰Šæ¸›
   - æœ€å°é™ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ§‹æˆï¼ˆcloud_native_gis, reference_dataset ã®ã¿ï¼‰

2. **ãƒ“ãƒ«ãƒ‰æ™‚é–“ã®è€ƒæ…®**:
   - åˆå›ãƒ“ãƒ«ãƒ‰: 30-60 åˆ†ï¼ˆPostGISã€pg-backupã€Djangoã€nginxï¼‰
   - 2 å›ç›®ä»¥é™: 10-15 åˆ†ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ©ç”¨ï¼‰
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®æ˜ç¢ºãªæ™‚é–“ã®æœŸå¾…å€¤è¨­å®šãŒé‡è¦

3. **VSCode ã®æ‰±ã„**:
   - GeoSight-OS ã® setup.sh ã¯ VSCode ã‚’æ¨å¥¨ã™ã‚‹ãŒã€Raspberry Pi ã§ã¯ä¸è¦
   - ãƒªã‚½ãƒ¼ã‚¹ã‚’ç¯€ç´„ã™ã‚‹ãŸã‚ã€å¿…é ˆã§ãªã„æ©Ÿèƒ½ã¯ç©æ¥µçš„ã«å‰Šé™¤

4. **Webpack ã®æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰æœ€é©åŒ–**:
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® `npm run dev` ã¯é–‹ç™ºç”¨ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã§ã€å¸¸æ™‚ CPU 180%ã€ãƒ¡ãƒ¢ãƒª 1GB ã‚’æ¶ˆè²»
   - `docker-compose.override.production.yml` ã§ `npm run build` ã«å¤‰æ›´ã—ã€ä¸€åº¦ã ã‘ãƒ“ãƒ«ãƒ‰ã—ã¦çµ‚äº†
   - ãƒ“ãƒ«ãƒ‰å¾Œã¯ `tail -f /dev/null` ã§å¾…æ©Ÿã—ã€healthcheck ã®ä¾å­˜é–¢ä¿‚ã‚’æº€ãŸã—ã¤ã¤ CPU ã‚’ã»ã¼æ¶ˆè²»ã—ãªã„
   - `mem_limit: 1536m` ã§ãƒ¡ãƒ¢ãƒªåˆ¶é™ã‚’è¨­å®šã—ã€Raspberry Pi 4B (4GB) ã§ OOM ã‚’é˜²æ­¢
   - `npm_cache` ã¨ `node_modules` ã‚’ volume ã§æ°¸ç¶šåŒ–ã—ã€å†èµ·å‹•æ™‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å›é¿
   - Healthcheck ã‚’ dev server ã®å¾…ã¡å—ã‘ãƒã‚§ãƒƒã‚¯ã‹ã‚‰ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã®å­˜åœ¨ç¢ºèªã«å¤‰æ›´
   - åˆå›ãƒ“ãƒ«ãƒ‰ã« 5-10 åˆ†ã‹ã‹ã‚‹ãŸã‚ã€`start_period: 300s` ã‚’è¨­å®š

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ**:
   - SECRET_KEY, DATABASE_PASSWORD, REDIS_PASSWORD ã‚’ OpenSSL ã§ç”Ÿæˆ
   - ååˆ†ãªã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’ç¢ºä¿ï¼ˆ50 æ–‡å­—ã€16 æ–‡å­—ï¼‰
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆadmin/adminï¼‰ã®å¤‰æ›´ã‚’å¼·ãä¿ƒã™

2. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é‡è¦æ€§**:
   - ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰ã®å•é¡Œï¼ˆARM64ï¼‰ã‚’æ˜ç¢ºã«æ–‡æ›¸åŒ–
   - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å…·ä½“çš„ãªè§£æ±ºç­–ã‚’è¨˜è¼‰
   - åˆå›å®Ÿè¡Œæ™‚ã®æœŸå¾…å€¤ï¼ˆæ™‚é–“ã€ãƒªã‚½ãƒ¼ã‚¹ï¼‰ã‚’æ˜ç¤º

## å‡ºå…¸ãƒ»å‚è€ƒè³‡æ–™ / References

- **GeoSight-OS**: https://github.com/unicef-drp/GeoSight-OS
- **GeoSight Documentation**: https://unicef-drp.github.io/GeoSight-OS-Documentation/
- **GeoRepo-OS**: https://github.com/unicef-drp/GeoRepo-OS
- **UN Smart Maps Issue #821**: https://github.com/UNopenGIS/7/issues/821
- **just Command Runner**: https://github.com/casey/just
- **Cloudflare Tunnel**: https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/

## è¬è¾ / Acknowledgments

- **UNICEF** - GeoSight ã®é–‹ç™ºã¨å…¬é–‹
- **Kartoza** - GeoSight ã®æŠ€è¡“çš„ãªé–‹ç™º
- **@yuiseki** - [UNopenGIS/7#821](https://github.com/UNopenGIS/7/issues/821) ã§ã® GeoSight ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã®ç™ºè¦‹ã¨å…±æœ‰
- **UN Smart Maps ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£** - ã‚ªãƒ¼ãƒ—ãƒ³ãªåœ°ç†ç©ºé–“æŠ€è¡“ã®æ¨é€²

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ / License

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ CC0 1.0 Universal (ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ‰ãƒ¡ã‚¤ãƒ³) ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

**é‡è¦ãªæ³¨æ„äº‹é … / Important Notes:**

- **æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç¯„å›²**: ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€GeoSight-OS ã‚’ Raspberry Pi ä¸Šã§èµ·å‹•ã™ã‚‹ãŸã‚ã®è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆJustfileï¼‰ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã¿ã‚’å«ã¿ã¾ã™ã€‚GeoSight-OS æœ¬ä½“ã®ã‚³ãƒ¼ãƒ‰ã¯å«ã¾ã‚Œã¦ãŠã‚‰ãšã€æ”¹å¤‰ã‚„å†é…å¸ƒã‚‚è¡Œã„ã¾ã›ã‚“ã€‚
- **GeoSight-OS ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**: GeoSight-OS æœ¬ä½“ã¯ [GNU AGPL v3](https://github.com/unicef-drp/GeoSight-OS/blob/main/LICENSE) ã®ä¸‹ã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ã€‚
- **AGPL ã®ä¼æ¬æ€§**: æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ GeoSight-OS ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®è¨­å®šã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’æä¾›ã™ã‚‹ã ã‘ã§ã‚ã‚Šã€GeoSight-OS ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å¤‰ã—ã¦ã„ãªã„ãŸã‚ã€AGPL ã®ã‚³ãƒ”ãƒ¼ãƒ¬ãƒ•ãƒˆæ¡é …ã¯æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯é©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚
- **UN Smart Maps ã§ã®è²¢çŒ®**: UN Smart Maps ã‚°ãƒ«ãƒ¼ãƒ—ã§ã® @hfu ã®è²¢çŒ®ã¯é€šå¸¸ CC0 ã¨ã—ã¦æä¾›ã•ã‚Œã¾ã™ã€‚

### What this means / æ„å‘³ã™ã‚‹ã¨ã“ã‚

This project (the Justfile and documentation) is released into the public domain under CC0. You can use, modify, and distribute it freely without restrictions. However, GeoSight-OS itself remains under GNU AGPL v3, which applies if you modify or distribute GeoSight-OS.

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆJustfile ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰ã¯CC0ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã—ã¦å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚åˆ¶é™ãªãè‡ªç”±ã«ä½¿ç”¨ã€æ”¹å¤‰ã€é…å¸ƒã§ãã¾ã™ã€‚ãŸã ã—ã€GeoSight-OS è‡ªä½“ã¯ GNU AGPL v3 ã®ã¾ã¾ã§ã‚ã‚Šã€GeoSight-OS ã‚’æ”¹å¤‰ã¾ãŸã¯é…å¸ƒã™ã‚‹å ´åˆã«ã¯ãã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚

## è²¢çŒ® / Contributing

Issues ã‚„ Pull Requests ã‚’æ­“è¿ã—ã¾ã™ã€‚

å¤‰æ›´å±¥æ­´ã«ã¤ã„ã¦ã¯ [CHANGELOG.md](CHANGELOG.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

Made with â¤ï¸ by [hfu](https://github.com/hfu) and GitHub Copilot
