# ARM64-specific Docker Compose override
# This file is automatically used when running on ARM64 architecture (Raspberry Pi)
# It replaces AMD64-only images with ARM64-compatible builds

services:
  # Replace kartoza/postgis:13.0 with ARM64-compatible build
  db:
    build:
      context: ./dockerfiles/postgis
      dockerfile: Dockerfile
    image: geosight-postgis:13-arm64
    platform: linux/arm64
    # Keep all other settings from main docker-compose.yml

  # Replace kartoza/pg-backup:13.0 with ARM64-compatible build
  dbbackups:
    build:
      context: ./dockerfiles/pg-backup
      dockerfile: Dockerfile
    image: geosight-pg-backup:13-arm64
    platform: linux/arm64
    # Keep all other settings from main docker-compose.yml

  # Disable logrotate on ARM64 (no ARM64-compatible image available)
  # Log rotation should be handled at the host level on Raspberry Pi
  logrotate:
    image: alpine:latest
    platform: linux/arm64
    entrypoint: ["/bin/sh", "-c", "echo 'Logrotate disabled on ARM64 - use host-level logrotate' && sleep infinity"]
    restart: "no"

